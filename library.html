<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANIMAX – Library</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #121212;
            --text: #ffffff;
            --accent: #00BCD4;
            --secondary: #E91E63;
            --glow-blue: rgba(0, 188, 212, 0.7);
            --glow-pink: rgba(233, 30, 99, 0.6);
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            padding: 2rem;
        }
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
        }
        header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            background: linear-gradient(45deg, var(--secondary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        #searchLib {
            width: 280px;
            padding: .6rem 1rem;
            border: 1px solid rgba(255, 255, 255, .2);
            border-radius: 99px;
            background: rgba(255, 255, 255, .07);
            color: var(--text);
            transition: .3s;
        }
        #searchLib:focus {
            border-color: var(--accent);
            box-shadow: 0 0 15px var(--glow-blue);
            outline: none;
        }
        .grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        }
        .card {
            background: rgba(255, 255, 255, .06);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: transform .3s, box-shadow .3s;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 35px #0008, 0 0 25px var(--glow-blue);
        }
        .card img {
            width: 100%;
            height: 220px;
            object-fit: cover;
        }
        .card p {
            padding: .6rem .8rem;
            font-size: .9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .load-more {
            text-align: center;
            margin-top: 2rem;
        }
        .load-more button {
            padding: .6rem 1.2rem;
            border: 1px solid var(--accent);
            background: transparent;
            color: var(--accent);
            border-radius: 8px;
            cursor: pointer;
            transition: .2s;
        }
        .load-more button:hover {
            background: var(--accent);
            color: var(--bg);
            box-shadow: 0 0 20px var(--glow-blue);
        }
    </style>
</head>
<body>

<header>
    <h1>ANIMAX – Library</h1>
    <input id="searchLib" placeholder="Search title…" autocomplete="off">
</header>

<div class="grid" id="libGrid"></div>
<div class="load-more"><button onclick="loadMoreLib()">Load more</button></div>

<script>
const PROXY = "https://corsproxy.io/?";
const LIST_URL = PROXY + encodeURIComponent("https://api.crunchyroll.com/content/v2/cms/browse?locale=en-US&n=30&start=");
let offset = 0;
let allAnime = [];

const $ = s => document.querySelector(s);
function card(a){
    return `<div class="card" onclick="alert('Playing: ${a.title}')">
                <img src="${a.poster}" alt=""><p>${a.title}</p>
            </div>`;
}
async function fetchBatch(start){
    const res = await fetch(LIST_URL + start).then(r => r.json());
    const batch = (res.data || []).map(it => ({
        id: it.id,
        title: it.title,
        poster: it.images.poster_tall?.[0]?.[0]?.source || "https://source.unsplash.com/random/300x440?anime"
    }));
    allAnime.push(...batch);
    return batch;
}
async function renderLib(){
    const items = await fetchBatch(offset);
    libGrid.insertAdjacentHTML('beforeend', items.map(card).join(''));
    offset += items.length;
    animateCards();
}
renderLib(); // initial

function loadMoreLib(){
    renderLib();
}
function animateCards(){
    anime({targets:'.card',translateY:[60,0],opacity:[0,1],delay:anime.stagger(80),easing:'easeOutQuart'});
}
searchLib.addEventListener('input', e => {
    const q = e.target.value.trim().toLowerCase();
    [...libGrid.children].forEach(c =>
        c.style.display = c.textContent.toLowerCase().includes(q) ? "" : "none"
    );
});
</script>

</body>
</html>
